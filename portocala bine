import pandas as pd
import numpy as np

def categorize_row(description, min_threshold=3):

    if not isinstance(description, str):

        return "No Description"

    desc_lower = description.lower()


    acc_count = desc_lower.count("accural")   
    rev_count = desc_lower.count("reversal")

    total = acc_count + rev_count

    if total < min_threshold:

        return description
    else:
        # We have enough hits; figure out which category
        if acc_count > 0 and rev_count > 0:
            return "Accural + Reversal"
        elif acc_count > 0:
            return "Accural"
        else:
            return "Reversal"

# part 2

import pandas as pd

df = pd.read_excel("your_file.xlsx")

df_pivot = df.pivot_table(
    index=["CC", "XO", "VOICE DATE", "JL Description"], 
    columns="Period",
    values="Amount",
    aggfunc="sum",
    fill_value=0
).reset_index()

df_pivot = df_pivot.sort_values(by="XO", ascending=True)

print(df_pivot)
df_pivot.to_excel("output.xlsx", index=False)


